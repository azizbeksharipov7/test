<div class="container">

  <!-- FILTER INPUTS -->
  <div class="filters">
    <input type="text" placeholder="Filter by Title" [(ngModel)]="filters.title" (input)="applyFilters()" />
    <input type="text" placeholder="Filter by Solved" [(ngModel)]="filters.has_solution" (input)="applyFilters()" />
  </div>

  <!-- PROBLEM TABLE -->
  <div class="mat-elevation-z8">
    <table mat-table [dataSource]="problems" class="mat-table" multiTemplateDataRows>

      <!-- TITLE -->
      <ng-container matColumnDef="title">
        <th mat-header-cell *matHeaderCellDef (click)="sort('title')">
          Title <span *ngIf="sortColumn === 'title'">({{ sortDirection }})</span>
        </th>
        <td mat-cell *matCellDef="let problem"> {{ problem.title }} </td>
      </ng-container>

      <!-- DIFFICULTY -->
      <ng-container matColumnDef="difficulty">
        <th mat-header-cell *matHeaderCellDef> Difficulty </th>
        <td mat-cell *matCellDef="let problem"> {{ problem.difficultyTitle }} </td>
      </ng-container>

      <!-- SOLVED -->
      <ng-container matColumnDef="has_solution">
        <th mat-header-cell *matHeaderCellDef (click)="sort('has_solution')">
          Solved <span *ngIf="sortColumn === 'has_solution'">({{ sortDirection }})</span>
        </th>
        <td mat-cell *matCellDef="let problem"> {{ problem.has_solution }} </td>
      </ng-container>

      <!-- TAGS -->
      <ng-container matColumnDef="tags">
        <th mat-header-cell *matHeaderCellDef> Tags </th>
        <td mat-cell *matCellDef="let problem">
          <ng-container *ngFor="let tag of problem.tags; let last = last">
            {{ tag.name }}<span *ngIf="!last">, </span>
          </ng-container>
        </td>
      </ng-container>

      <!-- ROWS -->
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>

  <!-- PAGINATION -->
  <mat-paginator
    [length]="totalProblems"
    [pageSize]="pageSize"
    [pageSizeOptions]="[5, 10, 20]"
    (page)="onPageChange($event)">
  </mat-paginator>

  <!-- NO RESULTS / LOADING -->
  <div *ngIf="!problems.length && !isLoading">
    <p>No problems found.</p>
  </div>
  <div *ngIf="isLoading">
    <p>Loading problems...</p>
  </div>
</div>
